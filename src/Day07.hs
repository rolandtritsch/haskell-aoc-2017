{-|
Problem: <https://adventofcode.com/2017/day/7>

Solution:

General - This is a tree searching problem.

Part1 - The root is the only node with no parent, means
it is never referenced as a child, means we can find it
by doing the diff between all nodes and all children.

Part2 - Find the root. Go through the tree (top-down) and
find the (bad) node, where the tree unbalanced (for the
first time). Find the wrong weight (the one that is
different to the other ones) and calc you to correct it.

Just for fun ... this is the tree :) ...
@
12
|
+- 22436
|  |
|  +- 35
|  |  |
|  |  +- 1731
|  |  |  |
|  |  |  +- 60
|  |  |  |  |
|  |  |  |  +- 70
|  |  |  |  |
|  |  |  |  `- 70
|  |  |  |
|  |  |  +- 10
|  |  |  |  |
|  |  |  |  +- 95
|  |  |  |  |
|  |  |  |  `- 95
|  |  |  |
|  |  |  `- 80
|  |  |     |
|  |  |     +- 60
|  |  |     |
|  |  |     `- 60
|  |  |
|  |  +- 1083
|  |  |  |
|  |  |  +- 344
|  |  |  |  |
|  |  |  |  +- 18
|  |  |  |  |
|  |  |  |  +- 18
|  |  |  |  |
|  |  |  |  +- 18
|  |  |  |  |
|  |  |  |  `- 18
|  |  |  |
|  |  |  +- 260
|  |  |  |  |
|  |  |  |  +- 78
|  |  |  |  |
|  |  |  |  `- 78
|  |  |  |
|  |  |  `- 72
|  |  |     |
|  |  |     +- 86
|  |  |     |
|  |  |     +- 86
|  |  |     |
|  |  |     +- 86
|  |  |     |
|  |  |     `- 86
|  |  |
|  |  +- 1631
|  |  |  |
|  |  |  +- 175
|  |  |  |
|  |  |  +- 5
|  |  |  |  |
|  |  |  |  +- 85
|  |  |  |  |
|  |  |  |  `- 85
|  |  |  |
|  |  |  +- 23
|  |  |  |  |
|  |  |  |  +- 76
|  |  |  |  |
|  |  |  |  `- 76
|  |  |  |
|  |  |  `- 135
|  |  |     |
|  |  |     +- 20
|  |  |     |
|  |  |     `- 20
|  |  |
|  |  +- 1992
|  |  |  |
|  |  |  +- 57
|  |  |  |  |
|  |  |  |  +- 28
|  |  |  |  |
|  |  |  |  `- 28
|  |  |  |
|  |  |  +- 113
|  |  |  |
|  |  |  `- 8
|  |  |     |
|  |  |     +- 35
|  |  |     |
|  |  |     +- 35
|  |  |     |
|  |  |     `- 35
|  |  |
|  |  +- 98
|  |  |  |
|  |  |  +- 207
|  |  |  |  |
|  |  |  |  +- 56
|  |  |  |  |
|  |  |  |  `- 56
|  |  |  |
|  |  |  +- 31
|  |  |  |  |
|  |  |  |  +- 96
|  |  |  |  |
|  |  |  |  +- 96
|  |  |  |  |
|  |  |  |  `- 96
|  |  |  |
|  |  |  +- 207
|  |  |  |  |
|  |  |  |  +- 56
|  |  |  |  |
|  |  |  |  `- 56
|  |  |  |
|  |  |  +- 319
|  |  |  |
|  |  |  +- 319
|  |  |  |
|  |  |  +- 319
|  |  |  |
|  |  |  `- 319
|  |  |
|  |  `- 1416
|  |     |
|  |     +- 77
|  |     |  |
|  |     |  +- 53
|  |     |  |
|  |     |  `- 53
|  |     |
|  |     +- 119
|  |     |  |
|  |     |  +- 32
|  |     |  |
|  |     |  `- 32
|  |     |
|  |     +- 111
|  |     |  |
|  |     |  +- 18
|  |     |  |
|  |     |  +- 18
|  |     |  |
|  |     |  +- 18
|  |     |  |
|  |     |  `- 18
|  |     |
|  |     +- 33
|  |     |  |
|  |     |  +- 75
|  |     |  |
|  |     |  `- 75
|  |     |
|  |     `- 79
|  |        |
|  |        +- 52
|  |        |
|  |        `- 52
|  |
|  +- 1571
|  |  |
|  |  +- 2145
|  |  |  |
|  |  |  +- 101
|  |  |  |  |
|  |  |  |  +- 7
|  |  |  |  |
|  |  |  |  `- 7
|  |  |  |
|  |  |  +- 103
|  |  |  |  |
|  |  |  |  +- 6
|  |  |  |  |
|  |  |  |  `- 6
|  |  |  |
|  |  |  `- 69
|  |  |     |
|  |  |     +- 23
|  |  |     |
|  |  |     `- 23
|  |  |
|  |  +- 1953
|  |  |  |
|  |  |  +- 139
|  |  |  |  |
|  |  |  |  +- 20
|  |  |  |  |
|  |  |  |  `- 20
|  |  |  |
|  |  |  +- 169
|  |  |  |  |
|  |  |  |  +- 5
|  |  |  |  |
|  |  |  |  `- 5
|  |  |  |
|  |  |  `- 49
|  |  |     |
|  |  |     +- 65
|  |  |     |
|  |  |     `- 65
|  |  |
|  |  +- 1076
|  |  |  |
|  |  |  +- 132
|  |  |  |  |
|  |  |  |  +- 35
|  |  |  |  |
|  |  |  |  `- 35
|  |  |  |
|  |  |  +- 22
|  |  |  |  |
|  |  |  |  +- 60
|  |  |  |  |
|  |  |  |  +- 60
|  |  |  |  |
|  |  |  |  `- 60
|  |  |  |
|  |  |  +- 202
|  |  |  |
|  |  |  +- 10
|  |  |  |  |
|  |  |  |  +- 96
|  |  |  |  |
|  |  |  |  `- 96
|  |  |  |
|  |  |  +- 68
|  |  |  |  |
|  |  |  |  +- 67
|  |  |  |  |
|  |  |  |  `- 67
|  |  |  |
|  |  |  +- 144
|  |  |  |  |
|  |  |  |  +- 29
|  |  |  |  |
|  |  |  |  `- 29
|  |  |  |
|  |  |  `- 202
|  |  |
|  |  +- 96
|  |  |  |
|  |  |  +- 399
|  |  |  |
|  |  |  +- 299
|  |  |  |  |
|  |  |  |  +- 50
|  |  |  |  |
|  |  |  |  `- 50
|  |  |  |
|  |  |  +- 345
|  |  |  |  |
|  |  |  |  +- 18
|  |  |  |  |
|  |  |  |  +- 18
|  |  |  |  |
|  |  |  |  `- 18
|  |  |  |
|  |  |  +- 237
|  |  |  |  |
|  |  |  |  +- 81
|  |  |  |  |
|  |  |  |  `- 81
|  |  |  |
|  |  |  +- 35
|  |  |  |  |
|  |  |  |  +- 91
|  |  |  |  |
|  |  |  |  +- 91
|  |  |  |  |
|  |  |  |  +- 91
|  |  |  |  |
|  |  |  |  `- 91
|  |  |  |
|  |  |  `- 273
|  |  |     |
|  |  |     +- 63
|  |  |     |
|  |  |     `- 63
|  |  |
|  |  `- 1402
|  |     |
|  |     +- 272
|  |     |
|  |     +- 196
|  |     |  |
|  |     |  +- 38
|  |     |  |
|  |     |  `- 38
|  |     |
|  |     +- 59
|  |     |  |
|  |     |  +- 71
|  |     |  |
|  |     |  +- 71
|  |     |  |
|  |     |  `- 71
|  |     |
|  |     `- 134
|  |        |
|  |        +- 69
|  |        |
|  |        `- 69
|  |
|  `- 7376
|     |
|     +- 541
|     |  |
|     |  +- 15
|     |  |  |
|     |  |  +- 91
|     |  |  |
|     |  |  `- 91
|     |  |
|     |  +- 87
|     |  |  |
|     |  |  +- 55
|     |  |  |
|     |  |  `- 55
|     |  |
|     |  +- 104
|     |  |  |
|     |  |  +- 31
|     |  |  |
|     |  |  +- 31
|     |  |  |
|     |  |  `- 31
|     |  |
|     |  `- 197
|     |
|     +- 855
|     |  |
|     |  +- 66
|     |  |  |
|     |  |  +- 23
|     |  |  |
|     |  |  +- 23
|     |  |  |
|     |  |  +- 23
|     |  |  |
|     |  |  `- 23
|     |  |
|     |  +- 77
|     |  |  |
|     |  |  +- 27
|     |  |  |
|     |  |  +- 27
|     |  |  |
|     |  |  `- 27
|     |  |
|     |  `- 140
|     |     |
|     |     +- 9
|     |     |
|     |     `- 9
|     |
|     +- 57
|     |  |
|     |  +- 57
|     |  |  |
|     |  |  +- 87
|     |  |  |
|     |  |  +- 87
|     |  |  |
|     |  |  `- 87
|     |  |
|     |  +- 238
|     |  |  |
|     |  |  +- 40
|     |  |  |
|     |  |  `- 40
|     |  |
|     |  +- 162
|     |  |  |
|     |  |  +- 78
|     |  |  |
|     |  |  `- 78
|     |  |
|     |  `- 126
|     |     |
|     |     +- 96
|     |     |
|     |     `- 96
|     |
|     +- 393
|     |  |
|     |  +- 75
|     |  |  |
|     |  |  +- 53
|     |  |  |
|     |  |  +- 53
|     |  |  |
|     |  |  `- 53
|     |  |
|     |  +- 94
|     |  |  |
|     |  |  +- 70
|     |  |  |
|     |  |  `- 70
|     |  |
|     |  +- 224
|     |  |  |
|     |  |  +- 5
|     |  |  |
|     |  |  `- 5
|     |  |
|     |  `- 88
|     |     |
|     |     +- 73
|     |     |
|     |     `- 73
|     |
|     `- 945
|        |
|        +- 96
|        |
|        +- 96
|        |
|        +- 96
|        |
|        `- 96
|
+- 94
|  |
|  +- 8516
|  |  |
|  |  +- 146
|  |  |  |
|  |  |  +- 91
|  |  |  |  |
|  |  |  |  +- 32
|  |  |  |  |
|  |  |  |  +- 32
|  |  |  |  |
|  |  |  |  `- 32
|  |  |  |
|  |  |  +- 23
|  |  |  |  |
|  |  |  |  +- 82
|  |  |  |  |
|  |  |  |  `- 82
|  |  |  |
|  |  |  +- 187
|  |  |  |
|  |  |  +- 165
|  |  |  |  |
|  |  |  |  +- 11
|  |  |  |  |
|  |  |  |  `- 11
|  |  |  |
|  |  |  +- 159
|  |  |  |  |
|  |  |  |  +- 14
|  |  |  |  |
|  |  |  |  `- 14
|  |  |  |
|  |  |  +- 105
|  |  |  |  |
|  |  |  |  +- 41
|  |  |  |  |
|  |  |  |  `- 41
|  |  |  |
|  |  |  `- 125
|  |  |     |
|  |  |     +- 31
|  |  |     |
|  |  |     `- 31
|  |  |
|  |  +- 67
|  |  |  |
|  |  |  +- 347
|  |  |  |
|  |  |  +- 251
|  |  |  |  |
|  |  |  |  +- 32
|  |  |  |  |
|  |  |  |  +- 32
|  |  |  |  |
|  |  |  |  `- 32
|  |  |  |
|  |  |  +- 291
|  |  |  |  |
|  |  |  |  +- 14
|  |  |  |  |
|  |  |  |  +- 14
|  |  |  |  |
|  |  |  |  +- 14
|  |  |  |  |
|  |  |  |  `- 14
|  |  |  |
|  |  |  `- 39
|  |  |     |
|  |  |     +- 77
|  |  |     |
|  |  |     +- 77
|  |  |     |
|  |  |     +- 77
|  |  |     |
|  |  |     `- 77
|  |  |
|  |  `- 455
|  |     |
|  |     +- 150
|  |     |  |
|  |     |  +- 50
|  |     |  |
|  |     |  `- 50
|  |     |
|  |     +- 250
|  |     |
|  |     +- 90
|  |     |  |
|  |     |  +- 80
|  |     |  |
|  |     |  `- 80
|  |     |
|  |     `- 174
|  |        |
|  |        +- 38
|  |        |
|  |        `- 38
|  |
|  +- 10574
|  |  |
|  |  +- 79
|  |  |  |
|  |  |  +- 144
|  |  |  |  |
|  |  |  |  +- 43
|  |  |  |  |
|  |  |  |  `- 43
|  |  |  |
|  |  |  +- 68
|  |  |  |  |
|  |  |  |  +- 54
|  |  |  |  |
|  |  |  |  +- 54
|  |  |  |  |
|  |  |  |  `- 54
|  |  |  |
|  |  |  `- 134
|  |  |     |
|  |  |     +- 48
|  |  |     |
|  |  |     `- 48
|  |  |
|  |  +- 313
|  |  |  |
|  |  |  +- 132
|  |  |  |  |
|  |  |  |  +- 10
|  |  |  |  |
|  |  |  |  `- 10
|  |  |  |
|  |  |  +- 88
|  |  |  |  |
|  |  |  |  +- 32
|  |  |  |  |
|  |  |  |  `- 32
|  |  |  |
|  |  |  `- 101
|  |  |     |
|  |  |     +- 17
|  |  |     |
|  |  |     +- 17
|  |  |     |
|  |  |     `- 17
|  |  |
|  |  `- 61
|  |     |
|  |     +- 140
|  |     |  |
|  |     |  +- 48
|  |     |  |
|  |     |  `- 48
|  |     |
|  |     +- 70
|  |     |  |
|  |     |  +- 83
|  |     |  |
|  |     |  `- 83
|  |     |
|  |     `- 176
|  |        |
|  |        +- 15
|  |        |
|  |        +- 15
|  |        |
|  |        +- 15
|  |        |
|  |        `- 15
|  |
|  +- 8558
|  |  |
|  |  +- 934
|  |  |  |
|  |  |  +- 153
|  |  |  |  |
|  |  |  |  +- 8
|  |  |  |  |
|  |  |  |  `- 8
|  |  |  |
|  |  |  +- 53
|  |  |  |  |
|  |  |  |  +- 29
|  |  |  |  |
|  |  |  |  +- 29
|  |  |  |  |
|  |  |  |  +- 29
|  |  |  |  |
|  |  |  |  `- 29
|  |  |  |
|  |  |  `- 133
|  |  |     |
|  |  |     +- 18
|  |  |     |
|  |  |     `- 18
|  |  |
|  |  +- 1309
|  |  |  |
|  |  |  +- 66
|  |  |  |
|  |  |  `- 66
|  |  |
|  |  `- 31
|  |     |
|  |     +- 470
|  |     |
|  |     +- 242
|  |     |  |
|  |     |  +- 57
|  |     |  |
|  |     |  +- 57
|  |     |  |
|  |     |  +- 57
|  |     |  |
|  |     |  `- 57
|  |     |
|  |     `- 98
|  |        |
|  |        +- 93
|  |        |
|  |        +- 93
|  |        |
|  |        +- 93
|  |        |
|  |        `- 93
|  |
|  +- 5387
|  |  |
|  |  +- 1133
|  |  |  |
|  |  |  +- 58
|  |  |  |
|  |  |  `- 58
|  |  |
|  |  +- 658
|  |  |  |
|  |  |  +- 83
|  |  |  |  |
|  |  |  |  +- 38
|  |  |  |  |
|  |  |  |  +- 38
|  |  |  |  |
|  |  |  |  `- 38
|  |  |  |
|  |  |  +- 197
|  |  |  |
|  |  |  `- 167
|  |  |     |
|  |  |     +- 15
|  |  |     |
|  |  |     `- 15
|  |  |
|  |  +- 298
|  |  |  |
|  |  |  +- 151
|  |  |  |  |
|  |  |  |  +- 83
|  |  |  |  |
|  |  |  |  `- 83
|  |  |  |
|  |  |  +- 317
|  |  |  |
|  |  |  `- 57
|  |  |     |
|  |  |     +- 65
|  |  |     |
|  |  |     +- 65
|  |  |     |
|  |  |     +- 65
|  |  |     |
|  |  |     `- 65
|  |  |
|  |  +- 337
|  |  |  |
|  |  |  +- 76
|  |  |  |  |
|  |  |  |  +- 57
|  |  |  |  |
|  |  |  |  +- 57
|  |  |  |  |
|  |  |  |  +- 57
|  |  |  |  |
|  |  |  |  `- 57
|  |  |  |
|  |  |  +- 304
|  |  |  |
|  |  |  `- 304
|  |  |
|  |  +- 511
|  |  |  |
|  |  |  +- 146
|  |  |  |  |
|  |  |  |  +- 50
|  |  |  |  |
|  |  |  |  `- 50
|  |  |  |
|  |  |  +- 84
|  |  |  |  |
|  |  |  |  +- 81
|  |  |  |  |
|  |  |  |  `- 81
|  |  |  |
|  |  |  `- 246
|  |  |
|  |  `- 81
|  |     |
|  |     +- 244
|  |     |  |
|  |     |  +- 24
|  |     |  |
|  |     |  `- 24
|  |     |
|  |     +- 292
|  |     |
|  |     +- 28
|  |     |  |
|  |     |  +- 88
|  |     |  |
|  |     |  +- 88
|  |     |  |
|  |     |  `- 88
|  |     |
|  |     `- 268
|  |        |
|  |        +- 12
|  |        |
|  |        `- 12
|  |
|  `- 56
|     |
|     +- 129
|     |  |
|     |  +- 112
|     |  |  |
|     |  |  +- 98
|     |  |  |
|     |  |  +- 98
|     |  |  |
|     |  |  `- 98
|     |  |
|     |  +- 406
|     |  |
|     |  +- 90
|     |  |  |
|     |  |  +- 79
|     |  |  |
|     |  |  +- 79
|     |  |  |
|     |  |  +- 79
|     |  |  |
|     |  |  `- 79
|     |  |
|     |  +- 253
|     |  |  |
|     |  |  +- 51
|     |  |  |
|     |  |  +- 51
|     |  |  |
|     |  |  `- 51
|     |  |
|     |  +- 226
|     |  |  |
|     |  |  +- 90
|     |  |  |
|     |  |  `- 90
|     |  |
|     |  `- 114
|     |     |
|     |     +- 73
|     |     |
|     |     +- 73
|     |     |
|     |     +- 73
|     |     |
|     |     `- 73
|     |
|     +- 669
|     |  |
|     |  +- 28
|     |  |  |
|     |  |  +- 72
|     |  |  |
|     |  |  +- 72
|     |  |  |
|     |  |  +- 72
|     |  |  |
|     |  |  `- 72
|     |  |
|     |  +- 182
|     |  |  |
|     |  |  +- 67
|     |  |  |
|     |  |  `- 67
|     |  |
|     |  +- 126
|     |  |  |
|     |  |  +- 95
|     |  |  |
|     |  |  `- 95
|     |  |
|     |  +- 205
|     |  |  |
|     |  |  +- 37
|     |  |  |
|     |  |  +- 37
|     |  |  |
|     |  |  `- 37
|     |  |
|     |  +- 242
|     |  |  |
|     |  |  +- 37
|     |  |  |
|     |  |  `- 37
|     |  |
|     |  `- 199
|     |     |
|     |     +- 39
|     |     |
|     |     +- 39
|     |     |
|     |     `- 39
|     |
|     +- 45
|     |  |
|     |  +- 256
|     |  |  |
|     |  |  +- 82
|     |  |  |
|     |  |  `- 82
|     |  |
|     |  +- 96
|     |  |  |
|     |  |  +- 81
|     |  |  |
|     |  |  +- 81
|     |  |  |
|     |  |  +- 81
|     |  |  |
|     |  |  `- 81
|     |  |
|     |  +- 180
|     |  |  |
|     |  |  +- 60
|     |  |  |
|     |  |  +- 60
|     |  |  |
|     |  |  +- 60
|     |  |  |
|     |  |  `- 60
|     |  |
|     |  +- 246
|     |  |  |
|     |  |  +- 87
|     |  |  |
|     |  |  `- 87
|     |  |
|     |  +- 244
|     |  |  |
|     |  |  +- 88
|     |  |  |
|     |  |  `- 88
|     |  |
|     |  `- 320
|     |     |
|     |     +- 50
|     |     |
|     |     `- 50
|     |
|     +- 760
|     |  |
|     |  +- 163
|     |  |  |
|     |  |  +- 66
|     |  |  |
|     |  |  +- 66
|     |  |  |
|     |  |  `- 66
|     |  |
|     |  +- 361
|     |  |
|     |  +- 106
|     |  |  |
|     |  |  +- 85
|     |  |  |
|     |  |  +- 85
|     |  |  |
|     |  |  `- 85
|     |  |
|     |  +- 45
|     |  |  |
|     |  |  +- 79
|     |  |  |
|     |  |  +- 79
|     |  |  |
|     |  |  +- 79
|     |  |  |
|     |  |  `- 79
|     |  |
|     |  `- 361
|     |
|     `- 2022
|        |
|        +- 181
|        |
|        +- 77
|        |  |
|        |  +- 52
|        |  |
|        |  `- 52
|        |
|        `- 151
|           |
|           +- 15
|           |
|           `- 15
|
+- 11729
|  |
|  +- 5564
|  |  |
|  |  +- 786
|  |  |  |
|  |  |  +- 97
|  |  |  |
|  |  |  +- 37
|  |  |  |  |
|  |  |  |  +- 30
|  |  |  |  |
|  |  |  |  `- 30
|  |  |  |
|  |  |  `- 7
|  |  |     |
|  |  |     +- 45
|  |  |     |
|  |  |     `- 45
|  |  |
|  |  +- 177
|  |  |  |
|  |  |  +- 33
|  |  |  |  |
|  |  |  |  +- 89
|  |  |  |  |
|  |  |  |  +- 89
|  |  |  |  |
|  |  |  |  `- 89
|  |  |  |
|  |  |  +- 144
|  |  |  |  |
|  |  |  |  +- 39
|  |  |  |  |
|  |  |  |  +- 39
|  |  |  |  |
|  |  |  |  +- 39
|  |  |  |  |
|  |  |  |  `- 39
|  |  |  |
|  |  |  `- 116
|  |  |     |
|  |  |     +- 92
|  |  |     |
|  |  |     `- 92
|  |  |
|  |  `- 69
|  |     |
|  |     +- 84
|  |     |  |
|  |     |  +- 42
|  |     |  |
|  |     |  +- 42
|  |     |  |
|  |     |  +- 42
|  |     |  |
|  |     |  `- 42
|  |     |
|  |     +- 96
|  |     |  |
|  |     |  +- 78
|  |     |  |
|  |     |  `- 78
|  |     |
|  |     +- 62
|  |     |  |
|  |     |  +- 95
|  |     |  |
|  |     |  `- 95
|  |     |
|  |     `- 196
|  |        |
|  |        +- 28
|  |        |
|  |        `- 28
|  |
|  +- 6041
|  |  |
|  |  +- 872
|  |  |  |
|  |  |  +- 23
|  |  |  |
|  |  |  `- 23
|  |  |
|  |  +- 180
|  |  |  |
|  |  |  +- 82
|  |  |  |  |
|  |  |  |  +- 82
|  |  |  |  |
|  |  |  |  `- 82
|  |  |  |
|  |  |  +- 82
|  |  |  |  |
|  |  |  |  +- 82
|  |  |  |  |
|  |  |  |  `- 82
|  |  |  |
|  |  |  `- 118
|  |  |     |
|  |  |     +- 64
|  |  |     |
|  |  |     `- 64
|  |  |
|  |  `- 94
|  |     |
|  |     +- 76
|  |     |  |
|  |     |  +- 65
|  |     |  |
|  |     |  `- 65
|  |     |
|  |     +- 206
|  |     |
|  |     +- 161
|  |     |  |
|  |     |  +- 15
|  |     |  |
|  |     |  +- 15
|  |     |  |
|  |     |  `- 15
|  |     |
|  |     `- 206
|  |
|  +- 35
|  |  |
|  |  +- 1037
|  |  |  |
|  |  |  +- 36
|  |  |  |  |
|  |  |  |  +- 35
|  |  |  |  |
|  |  |  |  +- 35
|  |  |  |  |
|  |  |  |  `- 35
|  |  |  |
|  |  |  +- 141
|  |  |  |
|  |  |  `- 63
|  |  |     |
|  |  |     +- 39
|  |  |     |
|  |  |     `- 39
|  |  |
|  |  +- 564
|  |  |  |
|  |  |  +- 26
|  |  |  |  |
|  |  |  |  +- 99
|  |  |  |  |
|  |  |  |  `- 99
|  |  |  |
|  |  |  +- 176
|  |  |  |  |
|  |  |  |  +- 24
|  |  |  |  |
|  |  |  |  `- 24
|  |  |  |
|  |  |  +- 82
|  |  |  |  |
|  |  |  |  +- 71
|  |  |  |  |
|  |  |  |  `- 71
|  |  |  |
|  |  |  `- 160
|  |  |     |
|  |  |     +- 16
|  |  |     |
|  |  |     +- 16
|  |  |     |
|  |  |     +- 16
|  |  |     |
|  |  |     `- 16
|  |  |
|  |  +- 974
|  |  |  |
|  |  |  +- 48
|  |  |  |  |
|  |  |  |  +- 57
|  |  |  |  |
|  |  |  |  `- 57
|  |  |  |
|  |  |  +- 128
|  |  |  |  |
|  |  |  |  +- 17
|  |  |  |  |
|  |  |  |  `- 17
|  |  |  |
|  |  |  `- 20
|  |  |     |
|  |  |     +- 71
|  |  |     |
|  |  |     `- 71
|  |  |
|  |  +- 251
|  |  |  |
|  |  |  +- 31
|  |  |  |  |
|  |  |  |  +- 93
|  |  |  |  |
|  |  |  |  +- 93
|  |  |  |  |
|  |  |  |  +- 93
|  |  |  |  |
|  |  |  |  `- 93
|  |  |  |
|  |  |  +- 315
|  |  |  |  |
|  |  |  |  +- 44
|  |  |  |  |
|  |  |  |  `- 44
|  |  |  |
|  |  |  `- 257
|  |  |     |
|  |  |     +- 73
|  |  |     |
|  |  |     `- 73
|  |  |
|  |  +- 40
|  |  |  |
|  |  |  +- 90
|  |  |  |  |
|  |  |  |  +- 97
|  |  |  |  |
|  |  |  |  `- 97
|  |  |  |
|  |  |  +- 104
|  |  |  |  |
|  |  |  |  +- 90
|  |  |  |  |
|  |  |  |  `- 90
|  |  |  |
|  |  |  +- 232
|  |  |  |  |
|  |  |  |  +- 26
|  |  |  |  |
|  |  |  |  `- 26
|  |  |  |
|  |  |  +- 41
|  |  |  |  |
|  |  |  |  +- 81
|  |  |  |  |
|  |  |  |  +- 81
|  |  |  |  |
|  |  |  |  `- 81
|  |  |  |
|  |  |  `- 134
|  |  |     |
|  |  |     +- 50
|  |  |     |
|  |  |     +- 50
|  |  |     |
|  |  |     `- 50
|  |  |
|  |  `- 1340
|  |     |
|  |     +- 60
|  |     |
|  |     `- 60
|  |
|  +- 4709
|  |  |
|  |  +- 46
|  |  |  |
|  |  |  +- 57
|  |  |  |  |
|  |  |  |  +- 68
|  |  |  |  |
|  |  |  |  +- 68
|  |  |  |  |
|  |  |  |  +- 68
|  |  |  |  |
|  |  |  |  `- 68
|  |  |  |
|  |  |  +- 45
|  |  |  |  |
|  |  |  |  +- 71
|  |  |  |  |
|  |  |  |  +- 71
|  |  |  |  |
|  |  |  |  +- 71
|  |  |  |  |
|  |  |  |  `- 71
|  |  |  |
|  |  |  +- 221
|  |  |  |  |
|  |  |  |  +- 54
|  |  |  |  |
|  |  |  |  `- 54
|  |  |  |
|  |  |  `- 285
|  |  |     |
|  |  |     +- 11
|  |  |     |
|  |  |     +- 11
|  |  |     |
|  |  |     +- 11
|  |  |     |
|  |  |     `- 11
|  |  |
|  |  +- 555
|  |  |  |
|  |  |  +- 191
|  |  |  |  |
|  |  |  |  +- 26
|  |  |  |  |
|  |  |  |  +- 26
|  |  |  |  |
|  |  |  |  `- 26
|  |  |  |
|  |  |  +- 236
|  |  |  |  |
|  |  |  |  +- 11
|  |  |  |  |
|  |  |  |  +- 11
|  |  |  |  |
|  |  |  |  `- 11
|  |  |  |
|  |  |  `- 73
|  |  |     |
|  |  |     +- 98
|  |  |     |
|  |  |     `- 98
|  |  |
|  |  `- 99
|  |     |
|  |     +- 29
|  |     |  |
|  |     |  +- 98
|  |     |  |
|  |     |  +- 98
|  |     |  |
|  |     |  +- 98
|  |     |  |
|  |     |  `- 98
|  |     |
|  |     +- 293
|  |     |  |
|  |     |  +- 64
|  |     |  |
|  |     |  `- 64
|  |     |
|  |     `- 337
|  |        |
|  |        +- 28
|  |        |
|  |        +- 28
|  |        |
|  |        `- 28
|  |
|  +- 1053
|  |  |
|  |  +- 461
|  |  |  |
|  |  |  +- 164
|  |  |  |  |
|  |  |  |  +- 17
|  |  |  |  |
|  |  |  |  +- 17
|  |  |  |  |
|  |  |  |  `- 17
|  |  |  |
|  |  |  +- 38
|  |  |  |  |
|  |  |  |  +- 59
|  |  |  |  |
|  |  |  |  +- 59
|  |  |  |  |
|  |  |  |  `- 59
|  |  |  |
|  |  |  `- 63
|  |  |     |
|  |  |     +- 38
|  |  |     |
|  |  |     +- 38
|  |  |     |
|  |  |     +- 38
|  |  |     |
|  |  |     `- 38
|  |  |
|  |  +- 731
|  |  |  |
|  |  |  +- 75
|  |  |  |  |
|  |  |  |  +- 25
|  |  |  |  |
|  |  |  |  `- 25
|  |  |  |
|  |  |  +- 107
|  |  |  |  |
|  |  |  |  +- 9
|  |  |  |  |
|  |  |  |  `- 9
|  |  |  |
|  |  |  `- 69
|  |  |     |
|  |  |     +- 28
|  |  |     |
|  |  |     `- 28
|  |  |
|  |  +- 566
|  |  |  |
|  |  |  +- 180
|  |  |  |
|  |  |  +- 166
|  |  |  |  |
|  |  |  |  +- 7
|  |  |  |  |
|  |  |  |  `- 7
|  |  |  |
|  |  |  `- 20
|  |  |     |
|  |  |     +- 80
|  |  |     |
|  |  |     `- 80
|  |  |
|  |  +- 122
|  |  |  |
|  |  |  +- 241
|  |  |  |  |
|  |  |  |  +- 29
|  |  |  |  |
|  |  |  |  +- 29
|  |  |  |  |
|  |  |  |  `- 29
|  |  |  |
|  |  |  +- 259
|  |  |  |  |
|  |  |  |  +- 23
|  |  |  |  |
|  |  |  |  +- 23
|  |  |  |  |
|  |  |  |  `- 23
|  |  |  |
|  |  |  `- 80
|  |  |     |
|  |  |     +- 62
|  |  |     |
|  |  |     +- 62
|  |  |     |
|  |  |     +- 62
|  |  |     |
|  |  |     `- 62
|  |  |
|  |  +- 14
|  |  |  |
|  |  |  +- 238
|  |  |  |  |
|  |  |  |  +- 63
|  |  |  |  |
|  |  |  |  `- 63
|  |  |  |
|  |  |  +- 364
|  |  |  |
|  |  |  `- 79
|  |  |     |
|  |  |     +- 95
|  |  |     |
|  |  |     +- 95
|  |  |     |
|  |  |     `- 95
|  |  |
|  |  +- 275
|  |  |  |
|  |  |  +- 199
|  |  |  |  |
|  |  |  |  +- 39
|  |  |  |  |
|  |  |  |  `- 39
|  |  |  |
|  |  |  +- 195
|  |  |  |  |
|  |  |  |  +- 41
|  |  |  |  |
|  |  |  |  `- 41
|  |  |  |
|  |  |  `- 40
|  |  |     |
|  |  |     +- 79
|  |  |     |
|  |  |     +- 79
|  |  |     |
|  |  |     `- 79
|  |  |
|  |  `- 428
|  |     |
|  |     +- 86
|  |     |  |
|  |     |  +- 70
|  |     |  |
|  |     |  `- 70
|  |     |
|  |     +- 106
|  |     |  |
|  |     |  +- 60
|  |     |  |
|  |     |  `- 60
|  |     |
|  |     `- 226
|  |
|  `- 5132
|     |
|     +- 84
|     |  |
|     |  +- 59
|     |  |  |
|     |  |  +- 80
|     |  |  |
|     |  |  +- 80
|     |  |  |
|     |  |  +- 80
|     |  |  |
|     |  |  `- 80
|     |  |
|     |  +- 253
|     |  |  |
|     |  |  +- 63
|     |  |  |
|     |  |  `- 63
|     |  |
|     |  `- 201
|     |     |
|     |     +- 89
|     |     |
|     |     `- 89
|     |
|     +- 336
|     |  |
|     |  +- 139
|     |  |  |
|     |  |  +- 78
|     |  |  |
|     |  |  `- 78
|     |  |
|     |  +- 163
|     |  |  |
|     |  |  +- 66
|     |  |  |
|     |  |  `- 66
|     |  |
|     |  `- 34
|     |     |
|     |     +- 87
|     |     |
|     |     +- 87
|     |     |
|     |     `- 87
|     |
|     `- 345
|        |
|        +- 53
|        |  |
|        |  +- 83
|        |  |
|        |  `- 83
|        |
|        +- 81
|        |  |
|        |  +- 69
|        |  |
|        |  `- 69
|        |
|        +- 201
|        |  |
|        |  +- 6
|        |  |
|        |  +- 6
|        |  |
|        |  `- 6
|        |
|        `- 138
|           |
|           +- 27
|           |
|           +- 27
|           |
|           `- 27
|
+- 46244
|  |
|  +- 4921
|  |  |
|  |  +- 231
|  |  |  |
|  |  |  +- 30
|  |  |  |
|  |  |  `- 30
|  |  |
|  |  +- 221
|  |  |  |
|  |  |  +- 35
|  |  |  |
|  |  |  `- 35
|  |  |
|  |  +- 228
|  |  |  |
|  |  |  +- 21
|  |  |  |
|  |  |  +- 21
|  |  |  |
|  |  |  `- 21
|  |  |
|  |  `- 19
|  |     |
|  |     +- 68
|  |     |
|  |     +- 68
|  |     |
|  |     +- 68
|  |     |
|  |     `- 68
|  |
|  +- 13
|  |  |
|  |  +- 362
|  |  |  |
|  |  |  +- 111
|  |  |  |  |
|  |  |  |  +- 83
|  |  |  |  |
|  |  |  |  `- 83
|  |  |  |
|  |  |  +- 81
|  |  |  |  |
|  |  |  |  +- 49
|  |  |  |  |
|  |  |  |  +- 49
|  |  |  |  |
|  |  |  |  +- 49
|  |  |  |  |
|  |  |  |  `- 49
|  |  |  |
|  |  |  +- 177
|  |  |  |  |
|  |  |  |  +- 50
|  |  |  |  |
|  |  |  |  `- 50
|  |  |  |
|  |  |  +- 41
|  |  |  |  |
|  |  |  |  +- 59
|  |  |  |  |
|  |  |  |  +- 59
|  |  |  |  |
|  |  |  |  +- 59
|  |  |  |  |
|  |  |  |  `- 59
|  |  |  |
|  |  |  +- 58
|  |  |  |  |
|  |  |  |  +- 73
|  |  |  |  |
|  |  |  |  +- 73
|  |  |  |  |
|  |  |  |  `- 73
|  |  |  |
|  |  |  `- 125
|  |  |     |
|  |  |     +- 76
|  |  |     |
|  |  |     `- 76
|  |  |
|  |  +- 49
|  |  |  |
|  |  |  +- 27
|  |  |  |  |
|  |  |  |  +- 92
|  |  |  |  |
|  |  |  |  +- 92
|  |  |  |  |
|  |  |  |  +- 92
|  |  |  |  |
|  |  |  |  `- 92
|  |  |  |
|  |  |  +- 239
|  |  |  |  |
|  |  |  |  +- 78
|  |  |  |  |
|  |  |  |  `- 78
|  |  |  |
|  |  |  +- 201
|  |  |  |  |
|  |  |  |  +- 97
|  |  |  |  |
|  |  |  |  `- 97
|  |  |  |
|  |  |  +- 265
|  |  |  |  |
|  |  |  |  +- 65
|  |  |  |  |
|  |  |  |  `- 65
|  |  |  |
|  |  |  `- 199
|  |  |     |
|  |  |     +- 98
|  |  |     |
|  |  |     `- 98
|  |  |
|  |  `- 156
|  |     |
|  |     +- 75
|  |     |  |
|  |     |  +- 98
|  |     |  |
|  |     |  +- 98
|  |     |  |
|  |     |  +- 98
|  |     |  |
|  |     |  `- 98
|  |     |
|  |     +- 467
|  |     |
|  |     +- 385
|  |     |  |
|  |     |  +- 41
|  |     |  |
|  |     |  `- 41
|  |     |
|  |     `- 353
|  |        |
|  |        +- 57
|  |        |
|  |        `- 57
|  |
|  `- 3877
|     |
|     +- 121
|     |  |
|     |  +- 205
|     |  |
|     |  +- 75
|     |  |  |
|     |  |  +- 65
|     |  |  |
|     |  |  `- 65
|     |  |
|     |  `- 153
|     |     |
|     |     +- 13
|     |     |
|     |     +- 13
|     |     |
|     |     +- 13
|     |     |
|     |     `- 13
|     |
|     +- 370
|     |  |
|     |  +- 32
|     |  |  |
|     |  |  +- 30
|     |  |  |
|     |  |  +- 30
|     |  |  |
|     |  |  `- 30
|     |  |
|     |  +- 28
|     |  |  |
|     |  |  +- 47
|     |  |  |
|     |  |  `- 47
|     |  |
|     |  `- 14
|     |     |
|     |     +- 54
|     |     |
|     |     `- 54
|     |
|     `- 46
|        |
|        +- 128
|        |  |
|        |  +- 5
|        |  |
|        |  `- 5
|        |
|        +- 14
|        |  |
|        |  +- 62
|        |  |
|        |  `- 62
|        |
|        +- 98
|        |  |
|        |  +- 20
|        |  |
|        |  `- 20
|        |
|        +- 138
|        |
|        `- 78
|           |
|           +- 30
|           |
|           `- 30
|
+- 38513
|  |
|  +- 643
|  |  |
|  |  +- 405
|  |  |  |
|  |  |  +- 28
|  |  |  |  |
|  |  |  |  +- 74
|  |  |  |  |
|  |  |  |  +- 74
|  |  |  |  |
|  |  |  |  +- 74
|  |  |  |  |
|  |  |  |  `- 74
|  |  |  |
|  |  |  +- 254
|  |  |  |  |
|  |  |  |  +- 35
|  |  |  |  |
|  |  |  |  `- 35
|  |  |  |
|  |  |  +- 202
|  |  |  |  |
|  |  |  |  +- 61
|  |  |  |  |
|  |  |  |  `- 61
|  |  |  |
|  |  |  +- 134
|  |  |  |  |
|  |  |  |  +- 95
|  |  |  |  |
|  |  |  |  `- 95
|  |  |  |
|  |  |  +- 324
|  |  |  |
|  |  |  +- 135
|  |  |  |  |
|  |  |  |  +- 63
|  |  |  |  |
|  |  |  |  +- 63
|  |  |  |  |
|  |  |  |  `- 63
|  |  |  |
|  |  |  `- 154
|  |  |     |
|  |  |     +- 85
|  |  |     |
|  |  |     `- 85
|  |  |
|  |  +- 97
|  |  |  |
|  |  |  +- 284
|  |  |  |  |
|  |  |  |  +- 21
|  |  |  |  |
|  |  |  |  +- 21
|  |  |  |  |
|  |  |  |  +- 21
|  |  |  |  |
|  |  |  |  `- 21
|  |  |  |
|  |  |  +- 222
|  |  |  |  |
|  |  |  |  +- 73
|  |  |  |  |
|  |  |  |  `- 73
|  |  |  |
|  |  |  +- 256
|  |  |  |  |
|  |  |  |  +- 56
|  |  |  |  |
|  |  |  |  `- 56
|  |  |  |
|  |  |  +- 98
|  |  |  |  |
|  |  |  |  +- 90
|  |  |  |  |
|  |  |  |  +- 90
|  |  |  |  |
|  |  |  |  `- 90
|  |  |  |
|  |  |  +- 71
|  |  |  |  |
|  |  |  |  +- 99
|  |  |  |  |
|  |  |  |  +- 99
|  |  |  |  |
|  |  |  |  `- 99
|  |  |  |
|  |  |  +- 332
|  |  |  |  |
|  |  |  |  +- 12
|  |  |  |  |
|  |  |  |  +- 12
|  |  |  |  |
|  |  |  |  `- 12
|  |  |  |
|  |  |  `- 206
|  |  |     |
|  |  |     +- 81
|  |  |     |
|  |  |     `- 81
|  |  |
|  |  `- 2145
|  |     |
|  |     +- 40
|  |     |  |
|  |     |  +- 34
|  |     |  |
|  |     |  +- 34
|  |     |  |
|  |     |  +- 34
|  |     |  |
|  |     |  `- 34
|  |     |
|  |     +- 78
|  |     |  |
|  |     |  +- 49
|  |     |  |
|  |     |  `- 49
|  |     |
|  |     `- 94
|  |        |
|  |        +- 41
|  |        |
|  |        `- 41
|  |
|  +- 14
|  |  |
|  |  +- 797
|  |  |  |
|  |  |  +- 225
|  |  |  |  |
|  |  |  |  +- 24
|  |  |  |  |
|  |  |  |  `- 24
|  |  |  |
|  |  |  +- 273
|  |  |  |
|  |  |  +- 75
|  |  |  |  |
|  |  |  |  +- 99
|  |  |  |  |
|  |  |  |  `- 99
|  |  |  |
|  |  |  +- 213
|  |  |  |  |
|  |  |  |  +- 30
|  |  |  |  |
|  |  |  |  `- 30
|  |  |  |
|  |  |  `- 149
|  |  |     |
|  |  |     +- 62
|  |  |     |
|  |  |     `- 62
|  |  |
|  |  +- 604
|  |  |  |
|  |  |  +- 113
|  |  |  |  |
|  |  |  |  +- 74
|  |  |  |  |
|  |  |  |  `- 74
|  |  |  |
|  |  |  +- 85
|  |  |  |  |
|  |  |  |  +- 44
|  |  |  |  |
|  |  |  |  +- 44
|  |  |  |  |
|  |  |  |  +- 44
|  |  |  |  |
|  |  |  |  `- 44
|  |  |  |
|  |  |  +- 237
|  |  |  |  |
|  |  |  |  +- 12
|  |  |  |  |
|  |  |  |  `- 12
|  |  |  |
|  |  |  +- 261
|  |  |  |
|  |  |  +- 219
|  |  |  |  |
|  |  |  |  +- 21
|  |  |  |  |
|  |  |  |  `- 21
|  |  |  |
|  |  |  `- 145
|  |  |     |
|  |  |     +- 58
|  |  |     |
|  |  |     `- 58
|  |  |
|  |  +- 26
|  |  |  |
|  |  |  +- 270
|  |  |  |  |
|  |  |  |  +- 43
|  |  |  |  |
|  |  |  |  `- 43
|  |  |  |
|  |  |  +- 308
|  |  |  |  |
|  |  |  |  +- 16
|  |  |  |  |
|  |  |  |  +- 16
|  |  |  |  |
|  |  |  |  `- 16
|  |  |  |
|  |  |  +- 107
|  |  |  |  |
|  |  |  |  +- 83
|  |  |  |  |
|  |  |  |  +- 83
|  |  |  |  |
|  |  |  |  `- 83
|  |  |  |
|  |  |  +- 24
|  |  |  |  |
|  |  |  |  +- 83
|  |  |  |  |
|  |  |  |  +- 83
|  |  |  |  |
|  |  |  |  +- 83
|  |  |  |  |
|  |  |  |  `- 83
|  |  |  |
|  |  |  +- 344
|  |  |  |  |
|  |  |  |  +- 6
|  |  |  |  |
|  |  |  |  `- 6
|  |  |  |
|  |  |  `- 292
|  |  |     |
|  |  |     +- 32
|  |  |     |
|  |  |     `- 32
|  |  |
|  |  `- 2040
|  |     |
|  |     +- 61
|  |     |
|  |     `- 61
|  |
|  `- 2026
|     |
|     +- 42
|     |  |
|     |  +- 49
|     |  |  |
|     |  |  +- 91
|     |  |  |
|     |  |  `- 91
|     |  |
|     |  +- 195
|     |  |  |
|     |  |  +- 18
|     |  |  |
|     |  |  `- 18
|     |  |
|     |  +- 89
|     |  |  |
|     |  |  +- 71
|     |  |  |
|     |  |  `- 71
|     |  |
|     |  +- 121
|     |  |  |
|     |  |  +- 55
|     |  |  |
|     |  |  `- 55
|     |  |
|     |  +- 65
|     |  |  |
|     |  |  +- 83
|     |  |  |
|     |  |  `- 83
|     |  |
|     |  +- 81
|     |  |  |
|     |  |  +- 75
|     |  |  |
|     |  |  `- 75
|     |  |
|     |  `- 175
|     |     |
|     |     +- 28
|     |     |
|     |     `- 28
|     |
|     +- 1561
|     |  |
|     |  +- 49
|     |  |
|     |  `- 49
|     |
|     +- 867
|     |  |
|     |  +- 52
|     |  |  |
|     |  |  +- 73
|     |  |  |
|     |  |  `- 73
|     |  |
|     |  +- 130
|     |  |  |
|     |  |  +- 34
|     |  |  |
|     |  |  `- 34
|     |  |
|     |  +- 172
|     |  |  |
|     |  |  +- 13
|     |  |  |
|     |  |  `- 13
|     |  |
|     |  `- 140
|     |     |
|     |     +- 29
|     |     |
|     |     `- 29
|     |
|     `- 875
|        |
|        +- 186
|        |  |
|        |  +- 5
|        |  |
|        |  `- 5
|        |
|        +- 50
|        |  |
|        |  +- 73
|        |  |
|        |  `- 73
|        |
|        +- 100
|        |  |
|        |  +- 32
|        |  |
|        |  +- 32
|        |  |
|        |  `- 32
|        |
|        `- 28
|           |
|           +- 84
|           |
|           `- 84
|
`- 35522
   |
   +- 47
   |  |
   |  +- 1504
   |  |  |
   |  |  +- 49
   |  |  |
   |  |  `- 49
   |  |
   |  +- 52
   |  |  |
   |  |  +- 124
   |  |  |  |
   |  |  |  +- 62
   |  |  |  |
   |  |  |  +- 62
   |  |  |  |
   |  |  |  `- 62
   |  |  |
   |  |  +- 204
   |  |  |  |
   |  |  |  +- 53
   |  |  |  |
   |  |  |  `- 53
   |  |  |
   |  |  +- 58
   |  |  |  |
   |  |  |  +- 84
   |  |  |  |
   |  |  |  +- 84
   |  |  |  |
   |  |  |  `- 84
   |  |  |
   |  |  +- 52
   |  |  |  |
   |  |  |  +- 86
   |  |  |  |
   |  |  |  +- 86
   |  |  |  |
   |  |  |  `- 86
   |  |  |
   |  |  `- 210
   |  |     |
   |  |     +- 25
   |  |     |
   |  |     +- 25
   |  |     |
   |  |     +- 25
   |  |     |
   |  |     `- 25
   |  |
   |  +- 152
   |  |  |
   |  |  +- 136
   |  |  |  |
   |  |  |  +- 77
   |  |  |  |
   |  |  |  `- 77
   |  |  |
   |  |  +- 220
   |  |  |  |
   |  |  |  +- 35
   |  |  |  |
   |  |  |  `- 35
   |  |  |
   |  |  +- 38
   |  |  |  |
   |  |  |  +- 84
   |  |  |  |
   |  |  |  +- 84
   |  |  |  |
   |  |  |  `- 84
   |  |  |
   |  |  +- 142
   |  |  |  |
   |  |  |  +- 74
   |  |  |  |
   |  |  |  `- 74
   |  |  |
   |  |  `- 258
   |  |     |
   |  |     +- 16
   |  |     |
   |  |     `- 16
   |  |
   |  +- 219
   |  |  |
   |  |  +- 461
   |  |  |
   |  |  +- 329
   |  |  |  |
   |  |  |  +- 66
   |  |  |  |
   |  |  |  `- 66
   |  |  |
   |  |  `- 93
   |  |     |
   |  |     +- 92
   |  |     |
   |  |     +- 92
   |  |     |
   |  |     +- 92
   |  |     |
   |  |     `- 92
   |  |
   |  +- 1053
   |  |  |
   |  |  +- 69
   |  |  |  |
   |  |  |  +- 57
   |  |  |  |
   |  |  |  `- 57
   |  |  |
   |  |  +- 121
   |  |  |  |
   |  |  |  +- 31
   |  |  |  |
   |  |  |  `- 31
   |  |  |
   |  |  `- 183
   |  |
   |  `- 370
   |     |
   |     +- 26
   |     |  |
   |     |  +- 75
   |     |  |
   |     |  `- 75
   |     |
   |     +- 8
   |     |  |
   |     |  +- 56
   |     |  |
   |     |  +- 56
   |     |  |
   |     |  `- 56
   |     |
   |     +- 30
   |     |  |
   |     |  +- 73
   |     |  |
   |     |  `- 73
   |     |
   |     +- 140
   |     |  |
   |     |  +- 18
   |     |  |
   |     |  `- 18
   |     |
   |     +- 42
   |     |  |
   |     |  +- 67
   |     |  |
   |     |  `- 67
   |     |
   |     +- 16
   |     |  |
   |     |  +- 80
   |     |  |
   |     |  `- 80
   |     |
   |     `- 90
   |        |
   |        +- 43
   |        |
   |        `- 43
   |
   +- 2699
   |  |
   |  +- 1020
   |  |  |
   |  |  +- 72
   |  |  |  |
   |  |  |  +- 84
   |  |  |  |
   |  |  |  `- 84
   |  |  |
   |  |  +- 72
   |  |  |  |
   |  |  |  +- 84
   |  |  |  |
   |  |  |  `- 84
   |  |  |
   |  |  `- 178
   |  |     |
   |  |     +- 31
   |  |     |
   |  |     `- 31
   |  |
   |  +- 736
   |  |  |
   |  |  +- 155
   |  |  |  |
   |  |  |  +- 48
   |  |  |  |
   |  |  |  `- 48
   |  |  |
   |  |  +- 199
   |  |  |  |
   |  |  |  +- 26
   |  |  |  |
   |  |  |  `- 26
   |  |  |
   |  |  +- 127
   |  |  |  |
   |  |  |  +- 62
   |  |  |  |
   |  |  |  `- 62
   |  |  |
   |  |  `- 57
   |  |     |
   |  |     +- 97
   |  |     |
   |  |     `- 97
   |  |
   |  +- 32
   |  |  |
   |  |  +- 110
   |  |  |  |
   |  |  |  +- 67
   |  |  |  |
   |  |  |  `- 67
   |  |  |
   |  |  +- 142
   |  |  |  |
   |  |  |  +- 34
   |  |  |  |
   |  |  |  +- 34
   |  |  |  |
   |  |  |  `- 34
   |  |  |
   |  |  +- 82
   |  |  |  |
   |  |  |  +- 54
   |  |  |  |
   |  |  |  +- 54
   |  |  |  |
   |  |  |  `- 54
   |  |  |
   |  |  +- 78
   |  |  |  |
   |  |  |  +- 83
   |  |  |  |
   |  |  |  `- 83
   |  |  |
   |  |  +- 68
   |  |  |  |
   |  |  |  +- 88
   |  |  |  |
   |  |  |  `- 88
   |  |  |
   |  |  +- 110
   |  |  |  |
   |  |  |  +- 67
   |  |  |  |
   |  |  |  `- 67
   |  |  |
   |  |  `- 13
   |  |     |
   |  |     +- 77
   |  |     |
   |  |     +- 77
   |  |     |
   |  |     `- 77
   |  |
   |  `- 636
   |     |
   |     +- 209
   |     |  |
   |     |  +- 53
   |     |  |
   |     |  +- 53
   |     |  |
   |     |  `- 53
   |     |
   |     +- 358
   |     |  |
   |     |  +- 5
   |     |  |
   |     |  `- 5
   |     |
   |     `- 44
   |        |
   |        +- 81
   |        |
   |        +- 81
   |        |
   |        +- 81
   |        |
   |        `- 81
   |
   `- 5960
      |
      +- 99
      |  |
      |  +- 30
      |  |  |
      |  |  +- 87
      |  |  |
      |  |  +- 87
      |  |  |
      |  |  +- 87
      |  |  |
      |  |  `- 87
      |  |
      |  +- 236
      |  |  |
      |  |  +- 71
      |  |  |
      |  |  `- 71
      |  |
      |  `- 238
      |     |
      |     +- 70
      |     |
      |     `- 70
      |
      +- 873
      |  |
      |  +- 120
      |  |
      |  +- 14
      |  |  |
      |  |  +- 53
      |  |  |
      |  |  `- 53
      |  |
      |  `- 60
      |     |
      |     +- 30
      |     |
      |     `- 30
      |
      `- 639
         |
         +- 88
         |  |
         |  +- 55
         |  |
         |  `- 55
         |
         +- 12
         |  |
         |  +- 93
         |  |
         |  `- 93
         |
         `- 48
            |
            +- 75
            |
            `- 75
@
-}
module Day07 where

import Data.List (isInfixOf, (\\))
import Data.List.Split (splitOneOf)
import Data.Maybe (fromJust)

import Data.Tree
import qualified Data.Map as M

import Util (inputRaw)

-- | need that map to build the Tree
type NodeName = String
type NodeStruct = (Int, [NodeName])
type NodeMap = M.Map NodeName NodeStruct

-- | read the input
input :: NodeMap
input = M.fromList $ map parser $ inputRaw "input/Day07input.txt" where
  parser line
    | isNode line = parseNode line
    | otherwise = parseLeaf line where
      isNode line = isInfixOf "->" line
      parseNode line = ((tokens !! 0), ((read $ tokens !! 1), (drop 2 tokens))) where
        -- kozpul (59) -> shavjjt, anujsv, tnzvo
        tokens = filter ((/=) "") $ splitOneOf "(),-> " line
      parseLeaf line = ((tokens !! 0), ((read $ tokens !! 1), [])) where
        -- occxa (60)
        tokens = filter ((/=) "") $ splitOneOf "() " line

-- | find the root element
findRoot :: NodeMap -> NodeName
findRoot allNodes = head $ allNames \\ allChildNames where
  allNames = M.keys allNodes
  allChildNames = concatMap snd $ M.elems allNodes

-- | build a/the tree. Use the node map and a/the root name. Return the root element
build :: NodeMap -> NodeName -> Tree Int
build allNodes root = unfoldTree buildTree root where
  buildTree name = fromJust $ M.lookup name allNodes

-- | draw a/the tree. Just for fun
drawWeightedTree :: NodeMap -> String
drawWeightedTree input = drawTree $ fmap show $ build input (findRoot input)

{--
-- | calc the weight of a given element (by suming up the weight of the subtree)
calcWeight :: Element -> Int
calcWeight Root = error "This should not happen"
calcWeight (Leaf _ w _) = w
calcWeight (Node _ w _ cs) = w + (sum $ map calcWeight cs)

-- | check, if the (sub)tree is balanced (if all children have the same weight)
isBalanced :: Element -> Bool
isBalanced Root = error "This should not happen"
isBalanced (Leaf _ _ _) = True
isBalanced (Node _ w _ cs) = all (\c -> (calcWeight c) == checkWeight) cs where
  checkWeight = calcWeight $ head cs

-- | find a/the bad node (by finding the node that is not balanced, but all of its
-- children are balanced; otherwise I have to go down more level)
findBadNode :: Element -> Element
findBadNode Root = error "This should not happen"
findBadNode (Leaf _ _ _) = error "This should not happen"
findBadNode n@(Node _ _ _ cs)
  | not (isBalanced n) && all isBalanced cs = n
  | otherwise = findBadNode $ fromJust $ find (\c -> not (isBalanced c)) cs

-- | for a given (bad) node, return the correct weight
correctWeight :: Element -> Int
correctWeight badNode = (weight bad) - (badWeight - goodWeight) where
  histo = group $ sort $ map calcWeight (children badNode)
  goodWeight = head $ fromJust $ find (\ws -> (length ws) > 1) histo
  badWeight = head $ fromJust $ find (\ws -> (length ws) == 1) histo
  bad = fromJust $ find (\c -> (calcWeight c) == badWeight) (children badNode)
--}
